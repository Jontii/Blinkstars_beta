{"version":3,"sources":["views/chat/ChatView/RecentThreads/Search.tsx","views/chat/ChatView/RecentThreads/ThreadItem.tsx","views/chat/ChatView/RecentThreads/ThreadList.tsx","views/chat/ChatView/RecentThreads/index.tsx","views/chat/ChatView/Settings.tsx","views/chat/ChatView/Thread/ComposeHeader.tsx","views/chat/ChatView/Thread/DetailHeader.tsx","views/chat/ChatView/Thread/MessageComposer.tsx","views/chat/ChatView/Thread/MessageItem.tsx","views/chat/ChatView/Thread/MessageList.tsx","views/chat/ChatView/Thread/index.tsx","views/chat/ChatView/index.tsx"],"names":["useStyles","makeStyles","theme","root","paddingLeft","spacing","paddingRight","search","display","alignItems","height","borderRadius","backgroundColor","palette","background","dark","searchInput","flexGrow","marginLeft","avatar","width","Search","forwardRef","ref","className","isFocused","onChange","onClickAway","onFocus","onSelect","query","results","rest","classes","displayResults","ClickAwayListener","clsx","SvgIcon","fontSize","color","Input","disableUnderline","placeholder","value","Box","mt","Typography","variant","List","map","result","ListItem","button","key","id","onClick","handleSelect","ListItemAvatar","Avatar","src","ListItemText","primary","name","primaryTypographyProps","noWrap","defaultProps","active","action","selected","boxShadow","secondary","main","smallAvatar","marginTop","unreadIndicator","minWidth","padding","ThreadItem","thread","details","currentUserId","otherParticipants","participants","filter","participant","displayNames","reduce","names","join","displayText","lastMessage","messages","length","sender","senderId","message","contentType","body","getDetails","AvatarGroup","max","alt","secondaryTypographyProps","ml","flexDirection","unreadCount","Chip","size","label","ThreadList","useSelector","state","chat","threads","activeThreadId","history","useHistory","allIds","threadId","byId","threadKey","type","find","username","push","hideThreadList","RecentThreads","useState","isSearchFocused","setSearchFocused","searchQuery","setSearchQuery","searchResults","setSearchResults","handleSearchChange","event","a","persist","target","axios","get","params","response","data","console","error","options","suppressScrollX","Settings","IconButton","component","RouterLink","to","container","recipient","marginRight","input","default","compactInput","maxWidth","ComposeHeader","onAddRecipient","onRemoveRecipient","recipients","containerRef","useRef","setQuery","filteredSearchResults","recipientIds","acc","includes","getFilteredSearchResults","onDelete","recipientId","onBlur","Popper","anchorEl","current","open","placement","Paper","pb","pt","px","textAlign","gutterBottom","contact","borderBottom","divider","flexShrink","minHeight","paddingBottom","paddingTop","DetailHeader","moreRef","openMenu","setOpenMenu","Tooltip","title","Menu","keepMounted","elevation","onClose","MenuItem","ListItemIcon","inputContainer","fileInput","MessageComposer","disabled","onSend","user","useAuth","fileInputRef","setBody","handleAttach","click","handleSend","fullWidth","onKeyUp","keyCode","Divider","edge","marginBottom","image","cursor","MessageItem","selectedImage","setSelectedImage","_participant","senderDetails","bgcolor","py","Link","justifyContent","moment","createdAt","fromNow","large","propTypes","PropTypes","string","object","isRequired","MessageList","scrollRef","useEffect","_container","scrollTop","scrollHeight","Thread","dispatch","useDispatch","useParams","unreadMessages","threadSelector","mode","handleSendMessage","getParticipants","getThread","resetActiveThread","markThreadAsSeen","addRecipient","removeRecipient","overflow","position","sidebar","borderRight","ChatView","pageRef","getThreads","Page"],"mappings":"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","file":"static/js/60.48bbfb5e.chunk.js","sourcesContent":["import {\n  Avatar,\n  Box,\n  ClickAwayListener,\n  Input,\n  List,\n  ListItem,\n  ListItemAvatar,\n  ListItemText,\n  makeStyles,\n  SvgIcon,\n  Typography\n} from '@material-ui/core';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { ChangeEvent, FC, FocusEvent, forwardRef } from 'react';\nimport { Search as SearchIcon } from 'react-feather';\nimport { Theme } from 'src/theme';\n\ninterface SearchProps {\n  className?: string;\n  isFocused?: boolean;\n  onChange?: (event: ChangeEvent<HTMLInputElement>) => void;\n  onClickAway?: () => void;\n  onFocus?: (event: FocusEvent<HTMLInputElement>) => void;\n  onSelect?: (result: any) => void;\n  query: string;\n  results: any[];\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  search: {\n    display: 'flex',\n    alignItems: 'center',\n    height: 44,\n    borderRadius: 22,\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2),\n    backgroundColor: theme.palette.background.dark\n  },\n  searchInput: {\n    flexGrow: 1,\n    marginLeft: theme.spacing(1)\n  },\n  avatar: {\n    height: 32,\n    width: 32\n  }\n}));\n\nconst Search: FC<SearchProps> = forwardRef(\n  (\n    {\n      className,\n      isFocused,\n      onChange,\n      onClickAway,\n      onFocus,\n      onSelect,\n      query,\n      results,\n      ...rest\n    },\n    ref\n  ) => {\n    const classes = useStyles();\n\n    const displayResults = query && isFocused;\n\n    const handleSelect = (result: any): void => {\n      if (onSelect) {\n        onSelect(result);\n      }\n    };\n\n    return (\n      <ClickAwayListener onClickAway={onClickAway}>\n        <div\n          className={clsx(classes.root, className)}\n          // @ts-ignore\n          ref={ref}\n          {...rest}\n        >\n          <div className={classes.search}>\n            <SvgIcon fontSize=\"small\" color=\"action\">\n              <SearchIcon />\n            </SvgIcon>\n            <Input\n              className={classes.searchInput}\n              disableUnderline\n              onChange={onChange}\n              onFocus={onFocus}\n              placeholder=\"Search contacts\"\n              value={query}\n            />\n          </div>\n          {displayResults && (\n            <Box mt={2}>\n              <Typography variant=\"h6\" color=\"textSecondary\">\n                Contacts\n              </Typography>\n              <List>\n                {results.map(result => {\n                  return (\n                    <ListItem\n                      button\n                      key={result.id}\n                      onClick={() => handleSelect(result)}\n                    >\n                      <ListItemAvatar>\n                        <Avatar\n                          src={result.avatar}\n                          className={classes.avatar}\n                        />\n                      </ListItemAvatar>\n                      <ListItemText\n                        primary={result.name}\n                        primaryTypographyProps={{\n                          noWrap: true,\n                          variant: 'h6',\n                          color: 'textPrimary'\n                        }}\n                      />\n                    </ListItem>\n                  );\n                })}\n              </List>\n            </Box>\n          )}\n        </div>\n      </ClickAwayListener>\n    );\n  }\n);\n\nSearch.propTypes = {\n  className: PropTypes.string,\n  onChange: PropTypes.func,\n  onClickAway: PropTypes.func,\n  onFocus: PropTypes.func,\n  onSelect: PropTypes.func,\n  query: PropTypes.string,\n  results: PropTypes.array\n};\n\nSearch.defaultProps = {\n  isFocused: false,\n  query: '',\n  results: []\n};\n\nexport default Search;\n","import {\n  Avatar,\n  Box,\n  Chip,\n  ListItem,\n  ListItemAvatar,\n  ListItemText,\n  makeStyles\n} from '@material-ui/core';\nimport { AvatarGroup } from '@material-ui/lab';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { FC } from 'react';\nimport { Theme } from 'src/theme';\nimport { Thread } from 'src/types/chat';\n\ninterface ThreadItemProps {\n  active?: boolean;\n  className?: string;\n  onSelect: () => void;\n  thread: Thread;\n}\n\nconst getDetails = (thread, currentUserId: string) => {\n  const otherParticipants = thread.participants.filter(\n    participant => participant.id !== currentUserId\n  );\n  const displayNames = otherParticipants\n    .reduce((names, participant) => [...names, participant.name], [])\n    .join(', ');\n  let displayText = '';\n  const lastMessage = thread.messages[thread.messages.length - 1];\n\n  if (lastMessage) {\n    const sender = lastMessage.senderId === currentUserId ? 'Me: ' : '';\n    const message =\n      lastMessage.contentType === 'image' ? 'Sent a photo' : lastMessage.body;\n\n    displayText = `${sender}${message}`;\n  }\n\n  return {\n    otherParticipants,\n    displayNames,\n    displayText\n  };\n};\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  active: {\n    backgroundColor: theme.palette.action.selected,\n    boxShadow: `inset 4px 0px 0px ${theme.palette.secondary.main}`\n  },\n  smallAvatar: {\n    height: 30,\n    width: 30,\n    '&:first-child': {\n      marginTop: 10\n    }\n  },\n  unreadIndicator: {\n    height: 18,\n    marginTop: 2,\n    minWidth: 18,\n    padding: 2\n  }\n}));\n\nconst ThreadItem: FC<ThreadItemProps> = ({\n  active,\n  className,\n  thread,\n  onSelect,\n  ...rest\n}) => {\n  const classes = useStyles();\n\n  // We hardcode the current user ID because the mocked that is not in sync with the auth provider.\n  // When implementing this app with a real database, replace this ID with the ID from Auth Context.\n  const details = getDetails(thread, '5e86809283e28b96d2d38537');\n\n  return (\n    <ListItem\n      button\n      className={clsx({ [classes.active]: active }, className)}\n      onClick={onSelect}\n      {...rest}\n    >\n      <ListItemAvatar>\n        <AvatarGroup\n          classes={{\n            avatar:\n              details.otherParticipants.length > 1 ? classes.smallAvatar : null\n          }}\n          max={2}\n        >\n          {details.otherParticipants.map(participant => (\n            <Avatar\n              alt=\"Person\"\n              key={participant.id}\n              src={participant.avatar}\n            />\n          ))}\n        </AvatarGroup>\n      </ListItemAvatar>\n      <ListItemText\n        primary={details.displayNames}\n        primaryTypographyProps={{\n          noWrap: true,\n          variant: 'h6',\n          color: 'textPrimary'\n        }}\n        secondary={details.displayText}\n        secondaryTypographyProps={{\n          noWrap: true,\n          variant: 'body2',\n          color: 'textSecondary'\n        }}\n      />\n      <Box ml={2} display=\"flex\" flexDirection=\"column\" alignItems=\"flex-end\">\n        {thread.unreadCount > 0 && (\n          <Chip\n            className={classes.unreadIndicator}\n            color=\"secondary\"\n            size=\"small\"\n            label={thread.unreadCount}\n          />\n        )}\n      </Box>\n    </ListItem>\n  );\n};\n\nThreadItem.propTypes = {\n  active: PropTypes.bool,\n  className: PropTypes.string,\n  onSelect: PropTypes.func,\n  // @ts-ignore\n  thread: PropTypes.object.isRequired\n};\n\nThreadItem.defaultProps = {\n  active: false,\n  onSelect: () => {}\n};\n\nexport default ThreadItem;\n","import { List, makeStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { FC } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useSelector } from 'src/store';\nimport ThreadItem from './ThreadItem';\n\ninterface ThreadListProps {\n  className?: string;\n}\n\nconst useStyles = makeStyles(() => ({\n  root: {}\n}));\n\nconst ThreadList: FC<ThreadListProps> = ({ className, ...rest }) => {\n  const classes = useStyles();\n  const { threads, activeThreadId } = useSelector(state => state.chat);\n  const history = useHistory();\n\n  const handleSelect = (threadId: string): void => {\n    const thread = threads.byId[threadId];\n    let threadKey = '';\n\n    if (thread.type === 'GROUP') {\n      threadKey = thread.id;\n    } else {\n      // We hardcode the current user ID because the mocked that is not in sync with the auth provider.\n      // When implementing this app with a real database, replace this ID with the ID from Auth Context.\n      const otherParticipant = thread.participants.find(\n        participant => participant.id !== '5e86809283e28b96d2d38537'\n      );\n\n      threadKey = otherParticipant.username;\n    }\n\n    history.push(`/app/chat/${threadKey}`);\n  };\n\n  return (\n    <List className={clsx(classes.root, className)} {...rest}>\n      {threads.allIds.map(threadId => (\n        <ThreadItem\n          active={activeThreadId === threadId}\n          key={threadId}\n          onSelect={() => handleSelect(threadId)}\n          thread={threads.byId[threadId]}\n        />\n      ))}\n    </List>\n  );\n};\n\nThreadList.propTypes = {\n  className: PropTypes.string\n};\n\nexport default ThreadList;\n","import { makeStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport React, { ChangeEvent, FC, FocusEvent, useState } from 'react';\nimport PerfectScrollbar from 'react-perfect-scrollbar';\nimport { useHistory } from 'react-router-dom';\nimport { Contact } from 'src/types/chat';\nimport axios from 'src/utils/axios';\nimport Search from './Search';\nimport ThreadList from './ThreadList';\n\nconst useStyles = makeStyles(() => ({\n  hideThreadList: {\n    display: 'none'\n  }\n}));\n\nconst RecentThreads: FC = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [isSearchFocused, setSearchFocused] = useState(false);\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  const [searchResults, setSearchResults] = useState<Contact[]>([]);\n\n  const handleSearchClickAway = (): void => {\n    setSearchFocused(false);\n    setSearchQuery('');\n  };\n\n  const handleSearchChange = async (\n    event: ChangeEvent<HTMLInputElement>\n  ): Promise<void> => {\n    try {\n      event.persist();\n\n      const { value } = event.target;\n\n      setSearchQuery(value);\n\n      if (value) {\n        const response = await axios.get<{ results: any[] }>(\n          '/api/chat/search',\n          {\n            params: {\n              query: value\n            }\n          }\n        );\n\n        setSearchResults(response.data.results);\n      } else {\n        setSearchResults([]);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleSearchFocus = (event: FocusEvent<HTMLInputElement>): void => {\n    event.persist();\n    setSearchFocused(true);\n  };\n\n  const handleSearchSelect = (result: any): void => {\n    setSearchFocused(false);\n    setSearchQuery('');\n    history.push(`/app/chat/${result.username}`);\n  };\n\n  return (\n    <PerfectScrollbar options={{ suppressScrollX: true }}>\n      <Search\n        isFocused={isSearchFocused}\n        onChange={handleSearchChange}\n        onClickAway={handleSearchClickAway}\n        onFocus={handleSearchFocus}\n        onSelect={handleSearchSelect}\n        query={searchQuery}\n        results={searchResults}\n      />\n      <ThreadList\n        className={clsx({ [classes.hideThreadList]: isSearchFocused })}\n      />\n    </PerfectScrollbar>\n  );\n};\n\nexport default RecentThreads;\n","import {\n  Box,\n  IconButton,\n  makeStyles,\n  SvgIcon,\n  Typography\n} from '@material-ui/core';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { FC } from 'react';\nimport { Edit as EditIcon, Settings as SettingsIcon } from 'react-feather';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { Theme } from 'src/theme';\n\ninterface SettingsProps {\n  className?: string;\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    height: 64,\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2)\n  }\n}));\n\nconst Settings: FC<SettingsProps> = ({ className, ...rest }) => {\n  const classes = useStyles();\n\n  return (\n    <div className={clsx(classes.root, className)} {...rest}>\n      <Typography variant=\"h3\" color=\"textPrimary\">\n        Chats\n      </Typography>\n      <Box flexGrow={1} />\n      <IconButton>\n        <SvgIcon fontSize=\"small\">\n          <SettingsIcon />\n        </SvgIcon>\n      </IconButton>\n      <IconButton component={RouterLink} to=\"/app/chat/new\">\n        <SvgIcon fontSize=\"small\">\n          <EditIcon />\n        </SvgIcon>\n      </IconButton>\n    </div>\n  );\n};\n\nSettings.propTypes = {\n  className: PropTypes.string\n};\n\nexport default Settings;\n","import {\n  Avatar,\n  Box,\n  Chip,\n  ClickAwayListener,\n  Input,\n  List,\n  ListItem,\n  ListItemAvatar,\n  ListItemText,\n  makeStyles,\n  Paper,\n  Popper,\n  Typography\n} from '@material-ui/core';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { ChangeEvent, FC, FocusEvent, useRef, useState } from 'react';\nimport { Theme } from 'src/theme';\nimport { Contact } from 'src/types/chat';\nimport axios from 'src/utils/axios';\n\ninterface ComposeHeaderProps {\n  className?: string;\n  onAddRecipient?: (contact: Contact) => void;\n  onRemoveRecipient?: (recipientId: string) => void;\n  recipients: any[];\n}\n\nconst getFilteredSearchResults = (\n  results: Contact[],\n  recipients: any[]\n): any[] => {\n  const recipientIds = recipients.reduce((acc, recipient) => {\n    return [...acc, recipient.id];\n  }, []);\n\n  return results.filter(result => !recipientIds.includes(result.id));\n};\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    alignItems: 'center',\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  container: {\n    marginLeft: theme.spacing(1)\n  },\n  recipient: {\n    marginLeft: 4,\n    marginRight: 4\n  },\n  input: {\n    backgroundColor: theme.palette.background.default,\n    borderRadius: 16,\n    height: 32,\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2)\n  },\n  compactInput: {\n    maxWidth: 120\n  },\n  searchResults: {\n    marginTop: theme.spacing(1),\n    maxWidth: '100%',\n    width: 320\n  }\n}));\n\nconst ComposeHeader: FC<ComposeHeaderProps> = ({\n  className,\n  onAddRecipient,\n  onRemoveRecipient,\n  recipients,\n  ...rest\n}) => {\n  const classes = useStyles();\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const [query, setQuery] = useState<string>('');\n  const [isSearchFocused, setSearchFocused] = useState<boolean>(true);\n  const [searchResults, setSearchResults] = useState<Contact[]>([]);\n\n  const filteredSearchResults = getFilteredSearchResults(\n    searchResults,\n    recipients\n  );\n  const displayResults = query && isSearchFocused;\n\n  const handleSearchChange = async (\n    event: ChangeEvent<HTMLInputElement>\n  ): Promise<void> => {\n    try {\n      event.persist();\n\n      const { value } = event.target;\n\n      setQuery(value);\n\n      if (value) {\n        const response = await axios.get<{ results: any[] }>(\n          '/api/chat/search',\n          {\n            params: {\n              query: value\n            }\n          }\n        );\n\n        setSearchResults(response.data.results);\n      } else {\n        setSearchResults([]);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleSearchBlur = (event: FocusEvent<HTMLInputElement>) => {\n    event.persist();\n\n    if (!displayResults) {\n      setSearchFocused(false);\n    }\n  };\n\n  const handleSearchFocus = (event: FocusEvent<HTMLInputElement>) => {\n    event.persist();\n    setSearchFocused(true);\n  };\n\n  const handleSearchResultsClickAway = (): void => {\n    setSearchFocused(false);\n  };\n\n  const handleAddRecipient = (contact: Contact): void => {\n    setQuery('');\n\n    if (onAddRecipient) {\n      onAddRecipient(contact);\n    }\n  };\n\n  const handleRemoveRecipient = (recipientId: string): void => {\n    if (onRemoveRecipient) {\n      onRemoveRecipient(recipientId);\n    }\n  };\n\n  return (\n    <div className={clsx(classes.root, className)} {...rest}>\n      <Typography variant=\"body1\" color=\"textSecondary\">\n        To:\n      </Typography>\n      <div className={classes.container} ref={containerRef}>\n        {recipients.map(recipient => (\n          <Chip\n            className={classes.recipient}\n            color=\"primary\"\n            key={recipient.id}\n            label={recipient.name}\n            onDelete={() => handleRemoveRecipient(recipient.id)}\n            size=\"small\"\n          />\n        ))}\n        <Input\n          className={clsx(classes.input, {\n            [classes.compactInput]: recipients.length > 0\n          })}\n          disableUnderline\n          onBlur={handleSearchBlur}\n          onChange={handleSearchChange}\n          onFocus={handleSearchFocus}\n          placeholder={recipients.length === 0 ? 'Search contacts' : ''}\n          value={query}\n        />\n      </div>\n      {displayResults && (\n        <ClickAwayListener onClickAway={handleSearchResultsClickAway}>\n          <Popper\n            anchorEl={containerRef.current}\n            open={isSearchFocused}\n            placement=\"bottom-start\"\n          >\n            <Paper className={classes.searchResults}>\n              {filteredSearchResults.length === 0 ? (\n                <Box pb={2} pt={2} px={2} textAlign=\"center\">\n                  <Typography color=\"textPrimary\" gutterBottom variant=\"h4\">\n                    Nothing Found\n                  </Typography>\n                  <Typography color=\"textSecondary\" variant=\"body2\">\n                    We couldn&apos;t find any matches for &quot;\n                    {query}\n                    &quot;. Try checking for typos or using complete words.\n                  </Typography>\n                </Box>\n              ) : (\n                <>\n                  <Box px={2} pt={2}>\n                    <Typography color=\"textSecondary\" variant=\"h6\">\n                      Contacts\n                    </Typography>\n                  </Box>\n                  <List>\n                    {filteredSearchResults.map(result => (\n                      <ListItem\n                        button\n                        key={result.id}\n                        onClick={() => handleAddRecipient(result)}\n                      >\n                        <ListItemAvatar>\n                          <Avatar src={result.avatar} />\n                        </ListItemAvatar>\n                        <ListItemText\n                          primary={result.name}\n                          primaryTypographyProps={{\n                            color: 'textPrimary',\n                            noWrap: true,\n                            variant: 'h6'\n                          }}\n                        />\n                      </ListItem>\n                    ))}\n                  </List>\n                </>\n              )}\n            </Paper>\n          </Popper>\n        </ClickAwayListener>\n      )}\n    </div>\n  );\n};\n\nComposeHeader.propTypes = {\n  className: PropTypes.string,\n  onAddRecipient: PropTypes.func,\n  onRemoveRecipient: PropTypes.func,\n  recipients: PropTypes.array\n};\n\nComposeHeader.defaultProps = {\n  onAddRecipient: () => {},\n  onRemoveRecipient: () => {},\n  recipients: []\n};\n\nexport default ComposeHeader;\n","import {\n  Avatar,\n  Box,\n  IconButton,\n  ListItemIcon,\n  ListItemText,\n  makeStyles,\n  Menu,\n  MenuItem,\n  SvgIcon,\n  Tooltip,\n  Typography\n} from '@material-ui/core';\nimport { AvatarGroup } from '@material-ui/lab';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { FC, useRef, useState } from 'react';\nimport {\n  Archive as ArchiveIcon,\n  BellOff as BellOffIcon,\n  Camera as CameraIcon,\n  MoreVertical as MoreIcon,\n  Phone as PhoneIcon,\n  Slash as SlashIcon,\n  Trash as TrashIcon\n} from 'react-feather';\nimport { Theme } from 'src/theme';\nimport { ThreadParticipant } from 'src/types/chat';\n\ninterface DetailHeaderProps {\n  className?: string;\n  participants: ThreadParticipant[];\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    alignItems: 'center',\n    backgroundColor: theme.palette.background.default,\n    borderBottom: `1px solid ${theme.palette.divider}`,\n    display: 'flex',\n    flexShrink: 0,\n    minHeight: 64,\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(2),\n    paddingRight: theme.spacing(2),\n    paddingTop: theme.spacing(1)\n  },\n  smallAvatar: {\n    height: 30,\n    width: 30,\n    '&:first-child': {\n      marginTop: 10\n    }\n  }\n}));\n\nconst DetailHeader: FC<DetailHeaderProps> = ({\n  className,\n  participants,\n  ...rest\n}) => {\n  const classes = useStyles();\n  const moreRef = useRef<any>(null);\n  const [openMenu, setOpenMenu] = useState<boolean>(false);\n\n  // We hardcode the current user ID because the mocked that is not in sync with the auth provider.\n  // When implementing this app with a real database, replace this ID with the ID from Auth Context.\n  const otherParticipants = participants.filter(\n    participant => participant.id !== '5e86809283e28b96d2d38537'\n  );\n  const displayNames = otherParticipants\n    .reduce((names, participant) => [...names, participant.name], [])\n    .join(', ');\n\n  const handleMenuOpen = (): void => {\n    setOpenMenu(true);\n  };\n\n  const handleMenuClose = (): void => {\n    setOpenMenu(false);\n  };\n\n  return (\n    <div className={clsx(classes.root, className)} {...rest}>\n      <Box alignItems=\"center\" display=\"flex\">\n        <AvatarGroup\n          classes={{\n            avatar: otherParticipants.length > 1 ? classes.smallAvatar : null\n          }}\n          max={2}\n        >\n          {otherParticipants.map(participant => (\n            <Avatar\n              alt=\"Person\"\n              key={participant.id}\n              src={participant.avatar}\n            />\n          ))}\n        </AvatarGroup>\n        <Typography color=\"textPrimary\" variant=\"h5\">\n          {displayNames}\n        </Typography>\n      </Box>\n      <Box flexGrow={1} />\n      <IconButton>\n        <SvgIcon fontSize=\"small\">\n          <PhoneIcon />\n        </SvgIcon>\n      </IconButton>\n      <IconButton>\n        <SvgIcon fontSize=\"small\">\n          <CameraIcon />\n        </SvgIcon>\n      </IconButton>\n      <Tooltip title=\"More options\">\n        <IconButton onClick={handleMenuOpen} ref={moreRef}>\n          <SvgIcon fontSize=\"small\">\n            <MoreIcon />\n          </SvgIcon>\n        </IconButton>\n      </Tooltip>\n      <Menu\n        anchorEl={moreRef.current}\n        keepMounted\n        elevation={1}\n        onClose={handleMenuClose}\n        open={openMenu}\n      >\n        <MenuItem>\n          <ListItemIcon>\n            <SvgIcon fontSize=\"small\">\n              <SlashIcon />\n            </SvgIcon>\n          </ListItemIcon>\n          <ListItemText primary=\"Block contact\" />\n        </MenuItem>\n        <MenuItem>\n          <ListItemIcon>\n            <SvgIcon fontSize=\"small\">\n              <TrashIcon />\n            </SvgIcon>\n          </ListItemIcon>\n          <ListItemText primary=\"Delete thread\" />\n        </MenuItem>\n        <MenuItem>\n          <ListItemIcon>\n            <SvgIcon fontSize=\"small\">\n              <ArchiveIcon />\n            </SvgIcon>\n          </ListItemIcon>\n          <ListItemText primary=\"Archive thread\" />\n        </MenuItem>\n        <MenuItem>\n          <ListItemIcon>\n            <SvgIcon fontSize=\"small\">\n              <BellOffIcon />\n            </SvgIcon>\n          </ListItemIcon>\n          <ListItemText primary=\"Mute notifications\" />\n        </MenuItem>\n      </Menu>\n    </div>\n  );\n};\n\nDetailHeader.propTypes = {\n  className: PropTypes.string,\n  participants: PropTypes.array\n};\n\nDetailHeader.defaultProps = {\n  participants: []\n};\n\nexport default DetailHeader;\n","import {\n  Avatar,\n  Divider,\n  IconButton,\n  Input,\n  makeStyles,\n  Paper,\n  SvgIcon,\n  Tooltip\n} from '@material-ui/core';\nimport AddPhotoIcon from '@material-ui/icons/AddPhotoAlternate';\nimport AttachFileIcon from '@material-ui/icons/AttachFile';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { ChangeEvent, FC, KeyboardEvent, useRef, useState } from 'react';\nimport { Send as SendIcon } from 'react-feather';\nimport useAuth from 'src/hooks/useAuth';\nimport { Theme } from 'src/theme';\n\ninterface MessageComposerProps {\n  className?: string;\n  disabled?: boolean;\n  onSend?: (value: string) => void;\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    alignItems: 'center',\n    backgroundColor: theme.palette.background.default,\n    display: 'flex',\n    padding: theme.spacing(1, 2)\n  },\n  inputContainer: {\n    flexGrow: 1,\n    marginLeft: theme.spacing(2),\n    padding: theme.spacing(1)\n  },\n  divider: {\n    height: 24,\n    width: 1\n  },\n  fileInput: {\n    display: 'none'\n  }\n}));\n\nconst MessageComposer: FC<MessageComposerProps> = ({\n  className,\n  disabled,\n  onSend,\n  ...rest\n}) => {\n  const classes = useStyles();\n  const { user } = useAuth();\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\n  const [body, setBody] = useState<string>('');\n\n  const handleAttach = (): void => {\n    fileInputRef.current.click();\n  };\n\n  const handleChange = (event: ChangeEvent<HTMLInputElement>): void => {\n    event.persist();\n    setBody(event.target.value);\n  };\n\n  const handleKeyUp = (event: KeyboardEvent<HTMLInputElement>): void => {\n    if (event.keyCode === 13) {\n      handleSend();\n    }\n  };\n\n  const handleSend = (): void => {\n    if (!body) {\n      return;\n    }\n\n    if (onSend) {\n      onSend(body);\n    }\n\n    setBody('');\n  };\n\n  return (\n    <div className={clsx(classes.root, className)} {...rest}>\n      <Avatar alt=\"Person\" src={user.avatar} />\n      <Paper variant=\"outlined\" className={classes.inputContainer}>\n        <Input\n          disableUnderline\n          fullWidth\n          value={body}\n          onChange={handleChange}\n          onKeyUp={handleKeyUp}\n          placeholder=\"Leave a message\"\n          disabled={disabled}\n        />\n      </Paper>\n      <Tooltip title=\"Send\">\n        <span>\n          <IconButton\n            color=\"secondary\"\n            disabled={!body || disabled}\n            onClick={handleSend}\n          >\n            <SvgIcon fontSize=\"small\">\n              <SendIcon />\n            </SvgIcon>\n          </IconButton>\n        </span>\n      </Tooltip>\n      <Divider className={classes.divider} />\n      <Tooltip title=\"Attach photo\">\n        <span>\n          <IconButton edge=\"end\" onClick={handleAttach} disabled={disabled}>\n            <AddPhotoIcon />\n          </IconButton>\n        </span>\n      </Tooltip>\n      <Tooltip title=\"Attach file\">\n        <span>\n          <IconButton edge=\"end\" onClick={handleAttach} disabled={disabled}>\n            <AttachFileIcon />\n          </IconButton>\n        </span>\n      </Tooltip>\n      <input className={classes.fileInput} ref={fileInputRef} type=\"file\" />\n    </div>\n  );\n};\n\nMessageComposer.propTypes = {\n  className: PropTypes.string,\n  disabled: PropTypes.bool,\n  onSend: PropTypes.func\n};\n\nMessageComposer.defaultProps = {\n  disabled: false,\n  onSend: () => {}\n};\n\nexport default MessageComposer;\n","import { Avatar, Box, Link, makeStyles, Typography } from '@material-ui/core';\nimport clsx from 'clsx';\nimport moment from 'moment';\nimport PropTypes from 'prop-types';\nimport React, { FC, useState } from 'react';\n// @ts-ignore\nimport { Lightbox } from 'react-modal-image';\nimport { Link as RouterLink } from 'react-router-dom';\nimport useAuth from 'src/hooks/useAuth';\nimport { Theme } from 'src/theme';\nimport { Thread, ThreadMessage } from 'src/types/chat';\n\ninterface MessageItemProps {\n  className?: string;\n  message: ThreadMessage;\n  thread: Thread;\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    marginBottom: theme.spacing(2),\n    display: 'flex'\n  },\n  avatar: {\n    height: 32,\n    width: 32\n  },\n  image: {\n    cursor: 'pointer',\n    height: 'auto',\n    maxWidth: '100%',\n    width: 380\n  }\n}));\n\nconst MessageItem: FC<MessageItemProps> = ({\n  className,\n  message,\n  thread,\n  ...rest\n}) => {\n  const classes = useStyles();\n  const { user } = useAuth();\n  const [selectedImage, setSelectedImage] = useState<string | null>(null);\n\n  // Since chat mock db is not synced with external auth providers\n  // we set the user details from user auth state instead of thread participants\n  const sender = thread.participants.find(\n    _participant => _participant.id === message.senderId\n  );\n  const senderDetails =\n    message.senderId === '5e86809283e28b96d2d38537'\n      ? {\n          avatar: user.avatar,\n          name: 'Me',\n          type: 'user'\n        }\n      : {\n          avatar: sender.avatar,\n          name: sender.name,\n          type: 'contact'\n        };\n\n  return (\n    <div className={clsx(classes.root, className)} {...rest}>\n      <Box\n        display=\"flex\"\n        maxWidth={500}\n        ml={senderDetails.type === 'user' ? 'auto' : 0}\n      >\n        <Avatar className={classes.avatar} src={senderDetails.avatar} />\n        <Box ml={2}>\n          <Box\n            bgcolor={\n              senderDetails.type === 'user'\n                ? 'secondary.main'\n                : 'background.default'\n            }\n            borderRadius=\"borderRadius\"\n            boxShadow={1}\n            color={\n              senderDetails.type === 'user'\n                ? 'secondary.contrastText'\n                : 'text.primary'\n            }\n            px={2}\n            py={1}\n          >\n            <Link color=\"inherit\" component={RouterLink} to=\"#\" variant=\"h6\">\n              {senderDetails.name}\n            </Link>\n            <Box mt={1}>\n              {message.contentType === 'image' ? (\n                <Box mt={2} onClick={() => setSelectedImage(message.body)}>\n                  <img\n                    alt=\"Attachment\"\n                    className={classes.image}\n                    src={message.body}\n                  />\n                </Box>\n              ) : (\n                <Typography color=\"inherit\" variant=\"body1\">\n                  {message.body}\n                </Typography>\n              )}\n            </Box>\n          </Box>\n          <Box mt={1} display=\"flex\" justifyContent=\"flex-end\">\n            <Typography noWrap color=\"textSecondary\" variant=\"caption\">\n              {moment(message.createdAt).fromNow()}\n            </Typography>\n          </Box>\n        </Box>\n      </Box>\n      {selectedImage && (\n        <Lightbox\n          large={selectedImage}\n          onClose={() => setSelectedImage(null)}\n        />\n      )}\n    </div>\n  );\n};\n\nMessageItem.propTypes = {\n  className: PropTypes.string,\n  // @ts-ignore\n  message: PropTypes.object.isRequired,\n  // @ts-ignore\n  thread: PropTypes.object.isRequired\n};\n\nexport default MessageItem;\n","import { makeStyles } from '@material-ui/core';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport React, { FC, useEffect, useRef } from 'react';\nimport PerfectScrollbar from 'react-perfect-scrollbar';\nimport { Theme } from 'src/theme';\nimport { Thread } from 'src/types/chat';\nimport MessageItem from './MessageItem';\n\ninterface MessageListProps {\n  className?: string;\n  thread: Thread;\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    padding: theme.spacing(2)\n  }\n}));\n\nconst MessageList: FC<MessageListProps> = ({ className, thread, ...rest }) => {\n  const classes = useStyles();\n  const scrollRef = useRef<any>(null);\n\n  useEffect(() => {\n    const scrollMessagesToBottom = () => {\n      if (scrollRef.current) {\n        scrollRef.current._container.scrollTop =\n          scrollRef.current._container.scrollHeight;\n      }\n    };\n\n    scrollMessagesToBottom();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [thread.messages]);\n\n  return (\n    <PerfectScrollbar\n      className={clsx(classes.root, className)}\n      options={{ suppressScrollX: true }}\n      ref={scrollRef}\n      {...rest}\n    >\n      {thread.messages.map(message => (\n        <MessageItem key={message.id} message={message} thread={thread} />\n      ))}\n    </PerfectScrollbar>\n  );\n};\n\nMessageItem.propTypes = {\n  className: PropTypes.string,\n  // @ts-ignore\n  thread: PropTypes.object.isRequired\n};\n\nexport default MessageList;\n","import { Box, Divider, makeStyles } from '@material-ui/core';\nimport React, { FC, useEffect } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport {\n  addRecipient,\n  getParticipants,\n  getThread,\n  markThreadAsSeen,\n  removeRecipient,\n  resetActiveThread\n} from 'src/slices/chat';\nimport { RootState, useDispatch, useSelector } from 'src/store';\nimport { Theme } from 'src/theme';\nimport ComposeHeader from './ComposeHeader';\nimport DetailHeader from './DetailHeader';\nimport MessageComposer from './MessageComposer';\nimport MessageList from './MessageList';\n\nconst threadSelector = (state: RootState): any => {\n  const { threads, activeThreadId } = state.chat;\n  const thread = threads.byId[activeThreadId];\n\n  if (thread) {\n    return thread;\n  }\n\n  return {\n    id: null,\n    messages: [],\n    participants: [],\n    unreadMessages: 0\n  };\n};\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    display: 'flex',\n    flexDirection: 'column',\n    flexGrow: 1\n  }\n}));\n\nconst Thread: FC = () => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const { threadKey } = useParams();\n  const { activeThreadId, participants, recipients } = useSelector(\n    state => state.chat\n  );\n  const thread = useSelector(state => threadSelector(state));\n\n  // In our case there two possible routes\n  // one that contains chat/new and one with a chat/:threadKey\n  // if threadKey does not exist, it means that the chat is in compose mode\n  const mode = threadKey ? 'DETAIL' : 'COMPOSE';\n\n  const handleAddRecipient = (recipient: any): void => {\n    dispatch(addRecipient(recipient));\n  };\n\n  const handleRemoveRecipient = (recipientId: string): void => {\n    dispatch(removeRecipient(recipientId));\n  };\n\n  const handleSendMessage = async (value: string): Promise<void> => {\n    try {\n      // Handle send message\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  useEffect(() => {\n    const getDetails = async () => {\n      dispatch(getParticipants(threadKey));\n\n      try {\n        await dispatch(getThread(threadKey));\n      } catch (err) {\n        // If thread key is not a valid key (thread id or username)\n        // the server throws an error, this means that the user tried a shady route\n        // and we redirect him on the compose route\n        console.error(err);\n        history.push('/app/chat/new');\n      }\n    };\n\n    // If path contains a thread key we do the following:\n    // 1) Load the thread participants based on the key\n    // 2) Try to find a related thread based on the key, it might not exist if it is a new tread\n    if (threadKey) {\n      getDetails();\n    } else {\n      // If no thread key specifid, but an active thread id exists in the\n      // store, reset that key. This means that the user navigated from details mode to compose\n      if (activeThreadId) {\n        dispatch(resetActiveThread());\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [threadKey]);\n\n  useEffect(() => {\n    if (activeThreadId) {\n      // Maybe we should also check if active thread\n      // has unread messages before triggering this\n      dispatch(markThreadAsSeen(activeThreadId));\n    }\n  }, [dispatch, activeThreadId]);\n\n  return (\n    <div className={classes.root}>\n      {mode === 'DETAIL' && <DetailHeader participants={participants} />}\n      {mode === 'COMPOSE' && (\n        <ComposeHeader\n          onAddRecipient={handleAddRecipient}\n          onRemoveRecipient={handleRemoveRecipient}\n          recipients={recipients}\n        />\n      )}\n      <Box flexGrow={1} overflow=\"hidden\">\n        <MessageList thread={thread} />\n      </Box>\n      <Divider />\n      <MessageComposer disabled onSend={handleSendMessage} />\n    </div>\n  );\n};\n\nexport default Thread;\n","import { makeStyles } from '@material-ui/core';\nimport React, { FC, useEffect, useRef } from 'react';\nimport Page from 'src/components/Page';\nimport { getThreads } from 'src/slices/chat';\nimport { useDispatch } from 'src/store';\nimport { Theme } from 'src/theme';\nimport RecentThreads from './RecentThreads';\nimport Settings from './Settings';\nimport Thread from './Thread';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    display: 'flex',\n    height: '100%',\n    overflow: 'hidden',\n    position: 'relative'\n  },\n  sidebar: {\n    backgroundColor: theme.palette.background.default,\n    borderRight: `1px solid ${theme.palette.divider}`,\n    width: 300\n  }\n}));\n\nconst ChatView: FC = () => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const pageRef = useRef<HTMLDivElement | null>(null);\n\n  useEffect(() => {\n    dispatch(getThreads());\n  }, [dispatch]);\n\n  return (\n    <Page className={classes.root} title=\"Chat\" ref={pageRef}>\n      <div className={classes.sidebar}>\n        <Settings />\n        <RecentThreads />\n      </div>\n      <Thread />\n    </Page>\n  );\n};\n\nexport default ChatView;\n"],"sourceRoot":""}
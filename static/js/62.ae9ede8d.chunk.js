(this["webpackJsonp@devias-io/material-kit-pro-react"]=this["webpackJsonp@devias-io/material-kit-pro-react"]||[]).push([[62],{2123:function(e,a,t){"use strict";t.r(a);var n=t(312),r=t(0),c=t.n(r),l=t(316),i=t(361),o=t(113),s=t(84),u=t(7),m=t.n(u),d=t(11),p=t(40),f=t(5),b=t(321),h=t.n(b),g=t(38),E=t(16),v=t(27),y=t(1045),O=t(111),j=t(2070),x=t(61),k=t(39),N=t(1049),S=t(1048),C=t(1088),w=t(146),R=t(1089),I=t(1241),T=Object(n.a)((function(e){return{root:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},search:{display:"flex",alignItems:"center",height:44,borderRadius:22,paddingLeft:e.spacing(2),paddingRight:e.spacing(2),backgroundColor:e.palette.background.dark},searchInput:{flexGrow:1,marginLeft:e.spacing(1)},avatar:{height:32,width:32}}})),P=Object(r.forwardRef)((function(e,a){var t=e.className,n=e.isFocused,r=e.onChange,l=e.onClickAway,i=e.onFocus,o=e.onSelect,s=e.query,u=e.results,m=Object(v.a)(e,["className","isFocused","onChange","onClickAway","onFocus","onSelect","query","results"]),d=T(),p=s&&n;return c.a.createElement(y.a,{onClickAway:l},c.a.createElement("div",Object.assign({className:Object(f.a)(d.root,t),ref:a},m),c.a.createElement("div",{className:d.search},c.a.createElement(O.a,{fontSize:"small",color:"action"},c.a.createElement(I.a,null)),c.a.createElement(j.a,{className:d.searchInput,disableUnderline:!0,onChange:r,onFocus:i,placeholder:"Search contacts",value:s})),p&&c.a.createElement(x.a,{mt:2},c.a.createElement(k.a,{variant:"h6",color:"textSecondary"},"Contacts"),c.a.createElement(N.a,null,u.map((function(e){return c.a.createElement(S.a,{button:!0,key:e.id,onClick:function(){return function(e){o&&o(e)}(e)}},c.a.createElement(C.a,null,c.a.createElement(w.a,{src:e.avatar,className:d.avatar})),c.a.createElement(R.a,{primary:e.name,primaryTypographyProps:{noWrap:!0,variant:"h6",color:"textPrimary"}}))}))))))}));P.defaultProps={isFocused:!1,query:"",results:[]};var A=P,L=t(42),z=t(1309),W=t(1575),F=Object(n.a)((function(e){return{active:{backgroundColor:e.palette.action.selected,boxShadow:"inset 4px 0px 0px ".concat(e.palette.secondary.main)},smallAvatar:{height:30,width:30,"&:first-child":{marginTop:10}},unreadIndicator:{height:18,marginTop:2,minWidth:18,padding:2}}})),M=function(e){var a=e.active,t=e.className,n=e.thread,r=e.onSelect,l=Object(v.a)(e,["active","className","thread","onSelect"]),i=F(),o=function(e,a){var t=e.participants.filter((function(e){return e.id!==a})),n=t.reduce((function(e,a){return[].concat(Object(L.a)(e),[a.name])}),[]).join(", "),r="",c=e.messages[e.messages.length-1];if(c){var l=c.senderId===a?"Me: ":"",i="image"===c.contentType?"Sent a photo":c.body;r="".concat(l).concat(i)}return{otherParticipants:t,displayNames:n,displayText:r}}(n,"5e86809283e28b96d2d38537");return c.a.createElement(S.a,Object.assign({button:!0,className:Object(f.a)(Object(s.a)({},i.active,a),t),onClick:r},l),c.a.createElement(C.a,null,c.a.createElement(W.a,{classes:{avatar:o.otherParticipants.length>1?i.smallAvatar:null},max:2},o.otherParticipants.map((function(e){return c.a.createElement(w.a,{alt:"Person",key:e.id,src:e.avatar})})))),c.a.createElement(R.a,{primary:o.displayNames,primaryTypographyProps:{noWrap:!0,variant:"h6",color:"textPrimary"},secondary:o.displayText,secondaryTypographyProps:{noWrap:!0,variant:"body2",color:"textSecondary"}}),c.a.createElement(x.a,{ml:2,display:"flex",flexDirection:"column",alignItems:"flex-end"},n.unreadCount>0&&c.a.createElement(z.a,{className:i.unreadIndicator,color:"secondary",size:"small",label:n.unreadCount})))};M.defaultProps={active:!1,onSelect:function(){}};var q=M,G=Object(n.a)((function(){return{root:{}}})),B=function(e){var a=e.className,t=Object(v.a)(e,["className"]),n=G(),r=Object(o.c)((function(e){return e.chat})),l=r.threads,i=r.activeThreadId,s=Object(g.g)();return c.a.createElement(N.a,Object.assign({className:Object(f.a)(n.root,a)},t),l.allIds.map((function(e){return c.a.createElement(q,{active:i===e,key:e,onSelect:function(){return function(e){var a=l.byId[e],t="";"GROUP"===a.type?t=a.id:t=a.participants.find((function(e){return"5e86809283e28b96d2d38537"!==e.id})).username;s.push("/app/chat/".concat(t))}(e)},thread:l.byId[e]})})))},D=Object(n.a)((function(){return{hideThreadList:{display:"none"}}})),U=function(){var e=D(),a=Object(g.g)(),t=Object(r.useState)(!1),n=Object(p.a)(t,2),l=n[0],i=n[1],o=Object(r.useState)(""),u=Object(p.a)(o,2),b=u[0],v=u[1],y=Object(r.useState)([]),O=Object(p.a)(y,2),j=O[0],x=O[1],k=function(){var e=Object(d.a)(m.a.mark((function e(a){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.persist(),t=a.target.value,v(t),!t){e.next=11;break}return e.next=7,E.a.get("/api/chat/search",{params:{query:t}});case 7:n=e.sent,x(n.data.results),e.next=12;break;case 11:x([]);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(a){return e.apply(this,arguments)}}();return c.a.createElement(h.a,{options:{suppressScrollX:!0}},c.a.createElement(A,{isFocused:l,onChange:k,onClickAway:function(){i(!1),v("")},onFocus:function(e){e.persist(),i(!0)},onSelect:function(e){i(!1),v(""),a.push("/app/chat/".concat(e.username))},query:b,results:j}),c.a.createElement(B,{className:Object(f.a)(Object(s.a)({},e.hideThreadList,l))}))},H=t(1086),J=t(2078),K=t(1576),X=t(20),_=Object(n.a)((function(e){return{root:{display:"flex",alignItems:"center",height:64,paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}}})),Q=function(e){var a=e.className,t=Object(v.a)(e,["className"]),n=_();return c.a.createElement("div",Object.assign({className:Object(f.a)(n.root,a)},t),c.a.createElement(k.a,{variant:"h3",color:"textPrimary"},"Chats"),c.a.createElement(x.a,{flexGrow:1}),c.a.createElement(H.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(J.a,null))),c.a.createElement(H.a,{component:X.a,to:"/app/chat/new"},c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(K.a,null))))},V=t(1077),Y=t(1055),Z=t(233),$=Object(n.a)((function(e){return{root:{alignItems:"center",display:"flex",padding:e.spacing(2)},container:{marginLeft:e.spacing(1)},recipient:{marginLeft:4,marginRight:4},input:{backgroundColor:e.palette.background.default,borderRadius:16,height:32,paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},compactInput:{maxWidth:120},searchResults:{marginTop:e.spacing(1),maxWidth:"100%",width:320}}})),ee=function(e){var a=e.className,t=e.onAddRecipient,n=e.onRemoveRecipient,l=e.recipients,i=Object(v.a)(e,["className","onAddRecipient","onRemoveRecipient","recipients"]),o=$(),u=Object(r.useRef)(null),b=Object(r.useState)(""),h=Object(p.a)(b,2),g=h[0],O=h[1],I=Object(r.useState)(!0),T=Object(p.a)(I,2),P=T[0],A=T[1],W=Object(r.useState)([]),F=Object(p.a)(W,2),M=F[0],q=F[1],G=function(e,a){var t=a.reduce((function(e,a){return[].concat(Object(L.a)(e),[a.id])}),[]);return e.filter((function(e){return!t.includes(e.id)}))}(M,l),B=g&&P,D=function(){var e=Object(d.a)(m.a.mark((function e(a){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.persist(),t=a.target.value,O(t),!t){e.next=11;break}return e.next=7,E.a.get("/api/chat/search",{params:{query:t}});case 7:n=e.sent,q(n.data.results),e.next=12;break;case 11:q([]);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(a){return e.apply(this,arguments)}}();return c.a.createElement("div",Object.assign({className:Object(f.a)(o.root,a)},i),c.a.createElement(k.a,{variant:"body1",color:"textSecondary"},"To:"),c.a.createElement("div",{className:o.container,ref:u},l.map((function(e){return c.a.createElement(z.a,{className:o.recipient,color:"primary",key:e.id,label:e.name,onDelete:function(){return a=e.id,void(n&&n(a));var a},size:"small"})})),c.a.createElement(j.a,{className:Object(f.a)(o.input,Object(s.a)({},o.compactInput,l.length>0)),disableUnderline:!0,onBlur:function(e){e.persist(),B||A(!1)},onChange:D,onFocus:function(e){e.persist(),A(!0)},placeholder:0===l.length?"Search contacts":"",value:g})),B&&c.a.createElement(y.a,{onClickAway:function(){A(!1)}},c.a.createElement(Y.a,{anchorEl:u.current,open:P,placement:"bottom-start"},c.a.createElement(Z.a,{className:o.searchResults},0===G.length?c.a.createElement(x.a,{pb:2,pt:2,px:2,textAlign:"center"},c.a.createElement(k.a,{color:"textPrimary",gutterBottom:!0,variant:"h4"},"Nothing Found"),c.a.createElement(k.a,{color:"textSecondary",variant:"body2"},"We couldn't find any matches for \"",g,'". Try checking for typos or using complete words.')):c.a.createElement(c.a.Fragment,null,c.a.createElement(x.a,{px:2,pt:2},c.a.createElement(k.a,{color:"textSecondary",variant:"h6"},"Contacts")),c.a.createElement(N.a,null,G.map((function(e){return c.a.createElement(S.a,{button:!0,key:e.id,onClick:function(){return a=e,O(""),void(t&&t(a));var a}},c.a.createElement(C.a,null,c.a.createElement(w.a,{src:e.avatar})),c.a.createElement(R.a,{primary:e.name,primaryTypographyProps:{color:"textPrimary",noWrap:!0,variant:"h6"}}))}))))))))};ee.defaultProps={onAddRecipient:function(){},onRemoveRecipient:function(){},recipients:[]};var ae=ee,te=t(1085),ne=t(1062),re=t(1081),ce=t(1189),le=t(2079),ie=t(2080),oe=t(1414),se=t(2081),ue=t(1322),me=t(1577),de=t(2082),pe=Object(n.a)((function(e){return{root:{alignItems:"center",backgroundColor:e.palette.background.default,borderBottom:"1px solid ".concat(e.palette.divider),display:"flex",flexShrink:0,minHeight:64,paddingBottom:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2),paddingTop:e.spacing(1)},smallAvatar:{height:30,width:30,"&:first-child":{marginTop:10}}}})),fe=function(e){var a=e.className,t=e.participants,n=Object(v.a)(e,["className","participants"]),l=pe(),i=Object(r.useRef)(null),o=Object(r.useState)(!1),s=Object(p.a)(o,2),u=s[0],m=s[1],d=t.filter((function(e){return"5e86809283e28b96d2d38537"!==e.id})),b=d.reduce((function(e,a){return[].concat(Object(L.a)(e),[a.name])}),[]).join(", ");return c.a.createElement("div",Object.assign({className:Object(f.a)(l.root,a)},n),c.a.createElement(x.a,{alignItems:"center",display:"flex"},c.a.createElement(W.a,{classes:{avatar:d.length>1?l.smallAvatar:null},max:2},d.map((function(e){return c.a.createElement(w.a,{alt:"Person",key:e.id,src:e.avatar})}))),c.a.createElement(k.a,{color:"textPrimary",variant:"h5"},b)),c.a.createElement(x.a,{flexGrow:1}),c.a.createElement(H.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(le.a,null))),c.a.createElement(H.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(ie.a,null))),c.a.createElement(te.a,{title:"More options"},c.a.createElement(H.a,{onClick:function(){m(!0)},ref:i},c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(oe.a,null)))),c.a.createElement(ne.a,{anchorEl:i.current,keepMounted:!0,elevation:1,onClose:function(){m(!1)},open:u},c.a.createElement(re.a,null,c.a.createElement(ce.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(se.a,null))),c.a.createElement(R.a,{primary:"Block contact"})),c.a.createElement(re.a,null,c.a.createElement(ce.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(ue.a,null))),c.a.createElement(R.a,{primary:"Delete thread"})),c.a.createElement(re.a,null,c.a.createElement(ce.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(me.a,null))),c.a.createElement(R.a,{primary:"Archive thread"})),c.a.createElement(re.a,null,c.a.createElement(ce.a,null,c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(de.a,null))),c.a.createElement(R.a,{primary:"Mute notifications"}))))};fe.defaultProps={participants:[]};var be=fe,he=t(1176),ge=t.n(he),Ee=t(1181),ve=t.n(Ee),ye=t(2083),Oe=t(69),je=Object(n.a)((function(e){return{root:{alignItems:"center",backgroundColor:e.palette.background.default,display:"flex",padding:e.spacing(1,2)},inputContainer:{flexGrow:1,marginLeft:e.spacing(2),padding:e.spacing(1)},divider:{height:24,width:1},fileInput:{display:"none"}}})),xe=function(e){var a=e.className,t=e.disabled,n=e.onSend,l=Object(v.a)(e,["className","disabled","onSend"]),i=je(),o=Object(Oe.a)().user,s=Object(r.useRef)(null),u=Object(r.useState)(""),m=Object(p.a)(u,2),d=m[0],b=m[1],h=function(){s.current.click()},g=function(){d&&(n&&n(d),b(""))};return c.a.createElement("div",Object.assign({className:Object(f.a)(i.root,a)},l),c.a.createElement(w.a,{alt:"Person",src:o.avatar}),c.a.createElement(Z.a,{variant:"outlined",className:i.inputContainer},c.a.createElement(j.a,{disableUnderline:!0,fullWidth:!0,value:d,onChange:function(e){e.persist(),b(e.target.value)},onKeyUp:function(e){13===e.keyCode&&g()},placeholder:"Leave a message",disabled:t})),c.a.createElement(te.a,{title:"Send"},c.a.createElement("span",null,c.a.createElement(H.a,{color:"secondary",disabled:!d||t,onClick:g},c.a.createElement(O.a,{fontSize:"small"},c.a.createElement(ye.a,null))))),c.a.createElement(V.a,{className:i.divider}),c.a.createElement(te.a,{title:"Attach photo"},c.a.createElement("span",null,c.a.createElement(H.a,{edge:"end",onClick:h,disabled:t},c.a.createElement(ge.a,null)))),c.a.createElement(te.a,{title:"Attach file"},c.a.createElement("span",null,c.a.createElement(H.a,{edge:"end",onClick:h,disabled:t},c.a.createElement(ve.a,null)))),c.a.createElement("input",{className:i.fileInput,ref:s,type:"file"}))};xe.defaultProps={disabled:!1,onSend:function(){}};var ke=xe,Ne=t(4),Se=t.n(Ne),Ce=t(1071),we=t(2),Re=t.n(we),Ie=t(1308),Te=Object(n.a)((function(e){return{root:{marginBottom:e.spacing(2),display:"flex"},avatar:{height:32,width:32},image:{cursor:"pointer",height:"auto",maxWidth:"100%",width:380}}})),Pe=function(e){var a=e.className,t=e.message,n=e.thread,l=Object(v.a)(e,["className","message","thread"]),i=Te(),o=Object(Oe.a)().user,s=Object(r.useState)(null),u=Object(p.a)(s,2),m=u[0],d=u[1],b=n.participants.find((function(e){return e.id===t.senderId})),h="5e86809283e28b96d2d38537"===t.senderId?{avatar:o.avatar,name:"Me",type:"user"}:{avatar:b.avatar,name:b.name,type:"contact"};return c.a.createElement("div",Object.assign({className:Object(f.a)(i.root,a)},l),c.a.createElement(x.a,{display:"flex",maxWidth:500,ml:"user"===h.type?"auto":0},c.a.createElement(w.a,{className:i.avatar,src:h.avatar}),c.a.createElement(x.a,{ml:2},c.a.createElement(x.a,{bgcolor:"user"===h.type?"secondary.main":"background.default",borderRadius:"borderRadius",boxShadow:1,color:"user"===h.type?"secondary.contrastText":"text.primary",px:2,py:1},c.a.createElement(Ce.a,{color:"inherit",component:X.a,to:"#",variant:"h6"},h.name),c.a.createElement(x.a,{mt:1},"image"===t.contentType?c.a.createElement(x.a,{mt:2,onClick:function(){return d(t.body)}},c.a.createElement("img",{alt:"Attachment",className:i.image,src:t.body})):c.a.createElement(k.a,{color:"inherit",variant:"body1"},t.body))),c.a.createElement(x.a,{mt:1,display:"flex",justifyContent:"flex-end"},c.a.createElement(k.a,{noWrap:!0,color:"textSecondary",variant:"caption"},Re()(t.createdAt).fromNow())))),m&&c.a.createElement(Ie.a,{large:m,onClose:function(){return d(null)}}))},Ae=Object(n.a)((function(e){return{root:{padding:e.spacing(2)}}}));Pe.propTypes={className:Se.a.string,thread:Se.a.object.isRequired};var Le=function(e){var a=e.className,t=e.thread,n=Object(v.a)(e,["className","thread"]),l=Ae(),i=Object(r.useRef)(null);return Object(r.useEffect)((function(){i.current&&(i.current._container.scrollTop=i.current._container.scrollHeight)}),[t.messages]),c.a.createElement(h.a,Object.assign({className:Object(f.a)(l.root,a),options:{suppressScrollX:!0},ref:i},n),t.messages.map((function(e){return c.a.createElement(Pe,{key:e.id,message:e,thread:t})})))},ze=Object(n.a)((function(e){return{root:{backgroundColor:e.palette.background.dark,display:"flex",flexDirection:"column",flexGrow:1}}})),We=function(){var e=ze(),a=Object(o.b)(),t=Object(g.g)(),n=Object(g.i)().threadKey,l=Object(o.c)((function(e){return e.chat})),s=l.activeThreadId,u=l.participants,p=l.recipients,f=Object(o.c)((function(e){return function(e){var a=e.chat,t=a.threads,n=a.activeThreadId,r=t.byId[n];return r||{id:null,messages:[],participants:[],unreadMessages:0}}(e)})),b=n?"DETAIL":"COMPOSE",h=function(){var e=Object(d.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){n?function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(Object(i.b)(n)),e.prev=1,e.next=4,a(Object(i.c)(n));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0),t.push("/app/chat/new");case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}()():s&&a(Object(i.h)())}),[n]),Object(r.useEffect)((function(){s&&a(Object(i.e)(s))}),[a,s]),c.a.createElement("div",{className:e.root},"DETAIL"===b&&c.a.createElement(be,{participants:u}),"COMPOSE"===b&&c.a.createElement(ae,{onAddRecipient:function(e){a(Object(i.a)(e))},onRemoveRecipient:function(e){a(Object(i.g)(e))},recipients:p}),c.a.createElement(x.a,{flexGrow:1,overflow:"hidden"},c.a.createElement(Le,{thread:f})),c.a.createElement(V.a,null),c.a.createElement(ke,{disabled:!0,onSend:h}))},Fe=Object(n.a)((function(e){return{root:{backgroundColor:e.palette.background.dark,display:"flex",height:"100%",overflow:"hidden",position:"relative"},sidebar:{backgroundColor:e.palette.background.default,borderRight:"1px solid ".concat(e.palette.divider),width:300}}}));a.default=function(){var e=Fe(),a=Object(o.b)(),t=Object(r.useRef)(null);return Object(r.useEffect)((function(){a(Object(i.d)())}),[a]),c.a.createElement(l.a,{className:e.root,title:"Chat",ref:t},c.a.createElement("div",{className:e.sidebar},c.a.createElement(Q,null),c.a.createElement(U,null)),c.a.createElement(We,null))}}}]);
//# sourceMappingURL=62.ae9ede8d.chunk.js.map